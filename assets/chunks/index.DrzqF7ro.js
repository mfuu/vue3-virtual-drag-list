import{g as At,c as Lt}from"./commonjsHelpers.Cpj98o6Y.js";import{d as Nt,ac as vt,s as mt,h as Ot,v as _t,an as Pt,ao as Ft,ap as Ut,y as Yt,z as Wt,aq as Xt}from"./framework.Be1hGwyf.js";var Kt={exports:{}};/*!
 * sortable-dnd v0.6.22
 * open source under the MIT license
 * https://github.com/mfuu/sortable-dnd#readme
 */(function(d,o){(function(i,r){d.exports=r()})(Lt,function(){function i(t){return i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(t)}function r(){return r=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},r.apply(this,arguments)}var u={capture:!1,passive:!1},f=/\s+/g;function z(t){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(t)}var j=z(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),nt=z(/Edge/i),_=z(/safari/i)&&!z(/chrome/i)&&!z(/android/i),it=function(){var t=!1;return document.addEventListener("checkIfSupportPassive",null,{get passive(){return t=!0,!0}}),t}();function k(t,e,n){window.addEventListener?t.addEventListener(e,n,!(!it&&j)&&u):window.attachEvent?t.attachEvent("on"+e,n):t["on"+e]=n}function M(t,e,n){window.removeEventListener?t.removeEventListener(e,n,!(!it&&j)&&u):window.detachEvent?t.detachEvent("on"+e,n):t["on"+e]=null}function gt(){return document.scrollingElement||document.documentElement}function L(t,e,n){if(t.getBoundingClientRect||t===window){var s,l,c,h,v,I,A;if(t!==window&&t.parentNode&&t!==gt()?(l=(s=t.getBoundingClientRect()).top,c=s.left,h=s.bottom,v=s.right,I=s.height,A=s.width):(l=0,c=0,h=window.innerHeight,v=window.innerWidth,I=window.innerHeight,A=window.innerWidth),e&&t!==window){n=n||t.parentNode;do if(n&&n.getBoundingClientRect){var T=n.getBoundingClientRect();l-=T.top+parseInt(w(n,"border-top-width")),c-=T.left+parseInt(w(n,"border-left-width")),h=l+s.height,v=c+s.width;break}while(n=n.parentNode)}return{top:l,left:c,bottom:h,right:v,width:A,height:I}}}function ht(t,e,n,s){if(t){n=n||document;do{if(e!=null&&(e[0]===">"?t.parentNode===n&&ut(t,e):ut(t,e))||s&&t===n)return t;if(t===n)break}while(t=t.parentNode);return null}}function yt(t,e){if(!t||!e)return!1;if(e.compareDocumentPosition)return!!(16&e.compareDocumentPosition(t));if(e.contains&&t.nodeType===1)return e.contains(t)&&e!==t;for(;t=t.parentNode;)if(t===e)return!0;return!1}function xt(t,e){for(var n=t.lastElementChild;n&&(n===D.ghost||w(n,"display")==="none"||e);)n=n.previousElementSibling;return n||null}function Q(t,e){if(!t||!t.parentNode)return-1;for(var n=0;t=t.previousElementSibling;)t.nodeName.toUpperCase()==="TEMPLATE"||e&&!ut(t,e)||w(t,"display")==="none"||n++;return n}function ot(t,e,n,s){for(var l=0,c=0,h=t.children;l<h.length;){if(h[l]!==D.ghost&&w(h[l],"display")!=="none"&&ht(h[l],n,t,!1)&&h[l]!==D.dragged){if(c===e)return h[l];c++}l++}return null}function rt(t,e){var n=w(t),s=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),l=ot(t,0,e),c=ot(t,1,e),h=l&&w(l),v=c&&w(c),I=h&&parseInt(h.marginLeft)+parseInt(h.marginRight)+L(l).width,A=v&&parseInt(v.marginLeft)+parseInt(v.marginRight)+L(c).width,T=nt||j?"cssFloat":"float";if(n.display==="flex")return n.flexDirection==="column"||n.flexDirection==="column-reverse"?"vertical":"horizontal";if(n.display==="grid")return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(l&&h.float&&h.float!=="none"){var C=h.float==="left"?"left":"right";return!c||v.clear!=="both"&&v.clear!==C?"horizontal":"vertical"}return l&&(h.display==="block"||h.display==="flex"||h.display==="table"||h.display==="grid"||I>=s&&n[T]==="none"||c&&n[T]==="none"&&I+A>s)?"vertical":"horizontal"}function F(t,e,n){if(t&&e)if(t.classList)t.classList[n?"add":"remove"](e);else{var s=(" "+t.className+" ").replace(f," ").replace(" "+e+" "," ");t.className=(s+(n?" "+e:"")).replace(f," ")}}function ut(t,e){if(e){if(e[0]===">"&&(e=e.substring(1)),t)try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch{return!1}return!1}}function w(t,e,n){var s=t&&t.style;if(s){if(n===void 0)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(n=t.currentStyle),e===void 0?n:n[e];e in s||e.indexOf("webkit")!==-1||(e="-webkit-"+e),s[e]=n+(typeof n=="string"?"":"px")}}function lt(t,e){var n,s,l=(s=e,(n=t).compareDocumentPosition?n.compareDocumentPosition(s):n.contains?(n!=s&&n.contains(s)&&16)+(n!=s&&s.contains(n)&&8)+(n.sourceIndex>=0&&s.sourceIndex>=0?(n.sourceIndex<s.sourceIndex&&4)+(n.sourceIndex>s.sourceIndex&&2):1):0);return l===2?1:l===4?-1:0}function S(t){t.preventDefault!==void 0&&t.cancelable&&t.preventDefault()}function R(t){var e=t.sortable,n=t.name,s=t.evt,l=e.options[n];typeof l=="function"&&l(r({},s))}(function(){if(typeof window>"u"||typeof document>"u")return"";var t=window.getComputedStyle(document.documentElement,"")||["-moz-hidden-iframe"];(Array.prototype.slice.call(t).join("").match(/-(moz|webkit|ms)-/)||t.OLink===""&&["","o"])[1]})();var E,at,St,U="Sortable"+Date.now();function It(t){this.options=t,this.scrollEl=null,this.autoScrollInterval=null}function zt(t){this.options=t,this.stack=[]}function Tt(t){this.options=t||{},this.selects=[]}It.prototype={nulling:function(){this.autoScrollInterval&&(clearInterval(this.autoScrollInterval),this.autoScrollInterval=null)},onStarted:function(){var t=this;this.nulling(),this.autoScrollInterval=setInterval(function(){t.autoScroll()})},onMove:function(t,e,n){this.options=n,this.scrollEl=t,this.moveEvent=e},autoScroll:function(){var t=this.moveEvent,e=this.scrollEl;if(e&&t.clientX!==void 0&&t.clientY!==void 0){var n=L(e);if(n){var s=t.clientX,l=t.clientY,c=n.top,h=n.right,v=n.bottom,I=n.left,A=n.height,T=n.width;if(!(l<c||s>h||l>v||s<I)){var C=this.options,tt=C.scrollThreshold,ft=C.scrollSpeed,st=e.scrollTop,pt=e.scrollLeft,O=e.scrollHeight,P=st>0&&l>=c&&l<=c+tt,Et=pt+T<e.scrollWidth&&s<=h&&s>=h-tt,Ct=st+A<O&&l<=v&&l>=v-tt;pt>0&&s>=I&&s<=I+tt&&(e.scrollLeft+=Math.floor(Math.max(-1,(s-I)/tt-1)*ft.x)),Et&&(e.scrollLeft+=Math.ceil(Math.min(1,(s-h)/tt+1)*ft.x)),P&&(e.scrollTop+=Math.floor(Math.max(-1,(l-c)/tt-1)*ft.y)),Ct&&(e.scrollTop+=Math.ceil(Math.min(1,(l-v)/tt+1)*ft.y))}}}}},zt.prototype={collect:function(t){if(t){for(var e=L(t),n=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,l=Math.min(e.right,n),c=Math.min(e.bottom,s),h=Array.prototype.slice.call(t.children),v=[],I=0,A=h.length;I<=A;I++){var T=h[I];if(T&&T!==D.ghost&&w(T,"display")!=="none"){var C=L(T);if(!(C.bottom<0||C.right<0)){if(C.top-C.height>c||C.left-C.width>l)break;v.push({el:T,rect:C})}}}this.stack.push(v)}},animate:function(){var t=this.stack.pop();if(t&&this.options.animation)for(var e=0,n=t.length;e<n;e++){var s=t[e],l=s.el,c=s.rect;this.execute(l,c)}},execute:function(t,e){var n=L(t);if(n.top!==e.top||n.left!==e.left){var s=e.left-n.left,l=e.top-n.top;w(t,"transition",""),w(t,"transform","translate3d(".concat(s,"px, ").concat(l,"px, 0)")),this.repaintDummy=function(I){return I.offsetWidth}(t);var c=this.options,h=c.animation,v=c.easing;w(t,"transition","transform ".concat(h,"ms ").concat(v?" "+v:"")),w(t,"transform","translate3d(0px, 0px, 0px)"),typeof t.animated=="number"&&clearTimeout(t.animated),t.animated=setTimeout(function(){w(t,"transition",""),w(t,"transform",""),t.animated=null},h)}}},Tt.prototype={eventProperties:function(){return{nodes:E||[],clones:at||[]}},isActive:function(){return!!E},nulling:function(){E=at=St=null},select:function(t){F(t,this.options.selectedClass,!0),this.selects.push(t),this.selects.sort(function(e,n){return lt(e,n)})},deselect:function(t){var e=this.selects.indexOf(t);e>-1&&(F(t,this.options.selectedClass,!1),this.selects.splice(e,1))},useSelectHandle:function(t,e){var n=this.options.selectHandle;return!!(St=typeof n=="function"&&n(t)||typeof n=="string"&&ut(e,n))},onChoose:function(){!this.options.multiple||this.selects.length===0||this.selects.indexOf(D.dragged)<0||(this.selects.sort(function(t,e){return lt(t,e)}),E=this.selects,this.toggleChosenClass(!0))},onDrop:function(t,e,n){if(E){var s=D.dragged,l=D.clone,c=E.indexOf(s);t!==e&&n?(w(l,"display","none"),this.toggleVisible(!0),at=E.map(function(h){return h.cloneNode(!0)}),this.sortElements(at,c,l)):this.sortElements(E,c,l),t!==e&&(e[U].multiplayer.toggleSelected(at||E,"add"),!n&&t[U].multiplayer.toggleSelected(E,"remove"))}},onSelect:function(t,e,n,s){var l=this.options,c=l.multiple,h=l.selectHandle;if(c&&(h&&St||!h&&!n)){var v=this.selects.indexOf(e);F(e,this.options.selectedClass,v<0);var I={from:s.el,event:t,node:e,index:Q(e)};v<0?(this.selects.push(e),R({sortable:s,name:"onSelect",evt:I})):(this.selects.splice(v,1),R({sortable:s,name:"onDeselect",evt:I})),this.selects.sort(function(A,T){return lt(A,T)})}},toggleChosenClass:function(t){if(E)for(var e=0,n=E.length;e<n;e++)F(E[e],this.options.chosenClass,t)},toggleVisible:function(t){if(E)for(var e=0,n=E.length;e<n;e++)E[e]!=D.dragged&&w(E[e],"display",t?"":"none")},toggleSelected:function(t,e){var n=this;e==="add"?t.forEach(function(s){return n.selects.push(s)}):this.selects=this.selects.filter(function(s){return t.indexOf(s)<0})},sortElements:function(t,e,n){for(var s=0,l=t.length;s<l;s++)if(w(t[s],"display",""),s<e)n.parentNode.insertBefore(t[s],n);else{var c=s>0?t[s-1]:n;n.parentNode.insertBefore(t[s],c.nextSibling)}}};var $,y,g,b,ct,m,H,B,G,N,a,p,x,J,K,Y,q,W,X,V,Z,bt,dt=[];function wt(t){var e,n,s,l={},c=t.group;c&&i(c)==="object"||(c={name:c,pull:!0,put:!0,revertDrag:!0}),l.name=c.name,l.pull=(e=c.pull)===null||e===void 0||e,l.put=(n=c.put)===null||n===void 0||n,l.revertDrag=(s=c.revertDrag)===null||s===void 0||s,t.group=l}function kt(t){var e=Y||K;return!(t.clientX!==void 0&&t.clientY!==void 0&&Math.abs(t.clientX-e.clientX)<=0&&Math.abs(t.clientY-e.clientY)<=0)}function D(t,e){if(!t||!t.nodeType||t.nodeType!==1)throw"Sortable-dnd: `el` must be an HTMLElement, not ".concat({}.toString.call(t));t[U]=this,this.el=t,this.options=e=r({},e);var n={store:null,group:"",handle:null,sortable:!0,disabled:!1,multiple:!1,lockAxis:"",direction:"",animation:150,easing:"",draggable:">*",selectHandle:null,customGhost:null,autoScroll:!0,scrollThreshold:55,scrollSpeed:{x:10,y:10},delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,ghostClass:"",ghostStyle:{},chosenClass:"",selectedClass:"",placeholderClass:"",swapOnDrop:!0,removeCloneOnDrop:!0,fallbackOnBody:!1,supportTouch:"ontouchstart"in window,emptyInsertThreshold:-1};for(var s in n)!(s in this.options)&&(this.options[s]=n[s]);for(var l in wt(e),this)l.charAt(0)==="_"&&typeof this[l]=="function"&&(this[l]=this[l].bind(this));k(t,this.options.supportTouch?"touchstart":"mousedown",this._onDrag),this.autoScroller=new It(this.options),this.multiplayer=new Tt(this.options),this.animator=new zt(this.options),dt.push(t)}return D.prototype={constructor:D,_onDrag:function(t){var e=this;if(!g&&!this.options.disabled&&this.options.group.pull&&(!/mousedown|pointerdown/.test(t.type)||t.button===0)){var n=t.touches&&t.touches[0],s=(n||t).target;if(!_||!s||s.tagName.toUpperCase()!=="SELECT"){var l=ht(s,this.options.draggable,this.el);if(l&&!l.animated&&(K={event:t,clientX:(n||t).clientX,clientY:(n||t).clientY},g=l,k(V=n?g:document,"mouseup",this._onDrop),k(V,"touchend",this._onDrop),k(V,"touchcancel",this._onDrop),!this.multiplayer.useSelectHandle(t,s))){var c=this.options.handle;if((typeof c!="function"||c(t))&&(typeof c!="string"||ut(s,c))){var h=this.options,v=h.delay,I=h.delayOnTouchOnly;!v||I&&!n||nt||j?this._onStart(n,t):(k(this.el.ownerDocument,"touchmove",this._delayMoveHandler),k(this.el.ownerDocument,"mousemove",this._delayMoveHandler),k(this.el.ownerDocument,"mouseup",this._cancelStart),k(this.el.ownerDocument,"touchend",this._cancelStart),k(this.el.ownerDocument,"touchcancel",this._cancelStart),bt=setTimeout(function(){return e._onStart(n,t)},v)),k(document,"selectstart",S),_&&w(document.body,"user-select","none")}}}}},_delayMoveHandler:function(t){var e=t.touches?t.touches[0]:t;Math.max(Math.abs(e.clientX-K.clientX),Math.abs(e.clientY-K.clientY))>=Math.floor(this.options.touchStartThreshold/(window.devicePixelRatio||1))&&this._cancelStart()},_cancelStart:function(){clearTimeout(bt),M(this.el.ownerDocument,"touchmove",this._delayMoveHandler),M(this.el.ownerDocument,"mousemove",this._delayMoveHandler),M(this.el.ownerDocument,"mouseup",this._cancelStart),M(this.el.ownerDocument,"touchend",this._cancelStart),M(this.el.ownerDocument,"touchcancel",this._cancelStart),M(document,"selectstart",S),_&&w(document.body,"user-select","")},_onStart:function(t,e){S(e);var n=Q(g);$=this.el,y=this.el,G=g,p=n,x=n,J=n,W={to:this.el,target:g,newIndex:n,relative:0},X=g,B=this.el,m=g.cloneNode(!0),N=g.parentNode,a=this.options.group.pull,D.clone=m,D.active=this,D.dragged=g,this.multiplayer.onChoose(),F(g,this.options.chosenClass,!0),R({sortable:this,name:"onChoose",evt:this._getEventProperties(e)}),k(V,t?"touchmove":"mousemove",this._nearestSortable);try{document.selection?setTimeout(function(){return document.selection.empty()},0):window.getSelection().removeAllRanges()}catch{}},_onStarted:function(){this.animator.collect(N),F(m,this.options.chosenClass,!0),F(m,this.options.placeholderClass,!0),this._appendGhost(),this.multiplayer.toggleVisible(!1),w(g,"display","none"),g.parentNode.insertBefore(m,g),R({sortable:this,name:"onDrag",evt:this._getEventProperties(K.event)}),this.animator.animate(),this.autoScroller.onStarted()},_getGhostElement:function(){var t=this.options.customGhost;if(typeof t=="function"){var e=this.multiplayer.selects;return t(this.multiplayer.isActive()?e:[g])}return g},_appendGhost:function(){if(!H){var t=this.options.fallbackOnBody?document.body:this.el,e=this._getGhostElement();F(H=e.cloneNode(!0),this.options.ghostClass,!0);var n=L(g),s=r({position:"fixed",top:n.top,left:n.left,width:n.width,height:n.height,zIndex:"100000",opacity:"0.8",overflow:"hidden",boxSizing:"border-box",transform:"",transition:"",pointerEvents:"none"},this.options.ghostStyle);for(var l in s)w(H,l,s[l]);D.ghost=H,t.appendChild(H);var c=(K.clientX-n.left)/parseInt(H.style.width)*100,h=(K.clientY-n.top)/parseInt(H.style.height)*100;w(H,"transform-origin","".concat(c,"% ").concat(h,"%")),w(H,"will-change","transform")}},_nearestSortable:function(t){S(t);var e=t.touches&&t.touches[0]||t;if(g&&kt(e)){!Y&&this._onStarted();var n=this.options.lockAxis,s=n==="x"?K.clientX:e.clientX,l=n==="y"?K.clientY:e.clientY,c=document.elementFromPoint(s,l),h=s-K.clientX,v=l-K.clientY;Y={event:t,clientX:s,clientY:l},w(H,"transform","translate3d(".concat(h,"px, ").concat(v,"px, 0)"));var I,A,T,C=(I=s,A=l,dt.reduce(function(st,pt){var O=pt[U].options.emptyInsertThreshold;if(O!=null){var P=L(pt),Et=I>=P.left-O&&I<=P.right+O,Ct=A>=P.top-O&&A<=P.bottom+O;return Et&&Ct&&(!T||T&&P.left>=T.left&&P.right<=T.right&&P.top>=T.top&&P.bottom<=T.bottom)&&(st=pt,T=P),st}},null));C&&C[U]._onMove(t,c);var tt=C?C[U].options:null,ft=null;(!C||tt.autoScroll)&&K&&Y&&(ft=function(st,pt){if(!st||!st.getBoundingClientRect)return gt();var O=st;do if(O.clientWidth<O.scrollWidth||O.clientHeight<O.scrollHeight){var P=w(O);if(O.clientWidth<O.scrollWidth&&(P.overflowX=="auto"||P.overflowX=="scroll")||O.clientHeight<O.scrollHeight&&(P.overflowY=="auto"||P.overflowY=="scroll"))return!O.getBoundingClientRect||O===document.body?gt():O}while(O=O.parentNode);return gt()}(c)),this.autoScroller.onMove(ft,Y,tt||this.options)}},_allowPut:function(){if(B===this.el)return!0;if(!this.options.group.put)return!1;var t=this.options.group,e=t.name,n=t.put,s=B[U].options.group;return n.join&&n.indexOf(s.name)>-1||s.name&&e&&s.name===e},_getDirection:function(){var t=this.options,e=t.draggable,n=t.direction;return n?typeof n=="function"?n.call(Y.event,m,this):n:rt(N,e)},_allowSwap:function(){var t=L(b),e=this._getDirection()==="vertical",n=e?"top":"left",s=e?"bottom":"right",l=b[e?"offsetHeight":"offsetWidth"],c=e?Y.clientY:Y.clientX,h=c>=t[n]&&c<t[s]-l/2?-1:1,v=ot(N,0,this.options.draggable),I=xt(N),A=L(v),T=L(I);if(b===N||yt(N,b))return m===v&&c<A[n]?(ct=b,!0):m===I&&c>T[s]&&(ct=b.nextSibling,!0);var C=lt(m,b);return ct=C<0?b.nextSibling:b,q!==b?(Z=h,!0):Z!==h&&(Z=h,h<0?C>0:C<0)},_onMove:function(t,e){if(!this.options.disabled&&this._allowPut()){if(b=ht(e,this.options.draggable,this.el),R({sortable:this,name:"onMove",evt:this._getEventProperties(t,{target:b})}),this.options.sortable||this.el!==B)return this.el===y||e!==this.el&&xt(this.el)?void(b&&!b.animated&&!yt(b,m)&&this._allowSwap()&&(b!==m&&ct!==m&&(this.el!==y?this._onInsert(t):b!==g&&this._onChange(t)),q=b)):(b=q=null,void this._onInsert(t));y!==B&&(b=q=g,Z=0,this._onInsert(t))}},_onInsert:function(t){var e=b||m,n=a==="clone"&&this.el!==B&&y===B,s=a==="clone"&&this.el===B&&y!==B,l=yt(b,document),c=b===g&&!l,h=y[U],v=B[U];$=this.el,p=Q(m),G=e,N=l?b.parentNode:this.el,h.animator.collect(m.parentNode),this.animator.collect(N),n&&(W.target=X,W.newIndex=p,W.relative=X===g?0:lt(m,X),w(g,"display",""),v.multiplayer.toggleVisible(!0),v.options.group.revertDrag||m.parentNode.insertBefore(g,m)),s&&(p=Q(g),w(g,"display","none"),this.multiplayer.toggleVisible(!1)),w(m,"display",c?"none":""),b&&l?N.insertBefore(m,Z<0?b:b.nextSibling):N.appendChild(m),x=c?J:Q(m),n&&v.options.group.revertDrag&&(W.target=g,W.newIndex=J,W.relative=0,R({sortable:v,name:"onChange",evt:this._getEventProperties(t,{to:B,target:g,newIndex:J,revertDrag:!0})})),n||R({sortable:h,name:"onRemove",evt:this._getEventProperties(t,{newIndex:-1})}),s&&e!==g&&(X=e,R({sortable:this,name:"onChange",evt:this._getEventProperties(t,{from:B,backToOrigin:!0})})),s||R({sortable:this,name:"onAdd",evt:this._getEventProperties(t,{oldIndex:-1})}),h.animator.animate(),this.animator.animate(),y=this.el},_onChange:function(t){this.animator.collect(N),p=Q(m),N=b.parentNode,G=b,this.el===B&&(X=b),N.insertBefore(m,ct),x=Q(m),R({sortable:this,name:"onChange",evt:this._getEventProperties(t)}),this.animator.animate(),y=this.el},_onDrop:function(t){this._cancelStart(),M(V,"touchmove",this._nearestSortable),M(V,"mousemove",this._nearestSortable),M(V,"mouseup",this._onDrop),M(V,"touchend",this._onDrop),M(V,"touchcancel",this._onDrop),B&&(y=B,p=J,G===m&&(G=g),this.animator.collect(N),this.multiplayer.toggleChosenClass(!1),F(g,this.options.chosenClass,!1),R({sortable:this,name:"onUnchoose",evt:this._getEventProperties(t)}),Y&&this._onEnd(t),!Y&&this.animator.animate()),!kt(t.changedTouches?t.changedTouches[0]:t)&&this.multiplayer.onSelect(t,g,B,this),H&&H.parentNode&&H.parentNode.removeChild(H),this._nulling()},_onEnd:function(t){F(m,this.options.chosenClass,!1),F(m,this.options.placeholderClass,!1);var e=a==="clone";this.multiplayer.onDrop(y,$,e);var n=this._getEventProperties(t),s=this.options,l=s.swapOnDrop,c=s.removeCloneOnDrop;e&&y!==$||!(typeof l=="function"?l(n):l)||N.insertBefore(g,m),e&&y!==$&&!this.multiplayer.isActive()||!(typeof c=="function"?c(n):c)||m&&m.parentNode&&m.parentNode.removeChild(m),w(g,"display",""),this.animator.animate(),y!==$&&R({sortable:y[U],name:"onDrop",evt:r({},n,e?W:{newIndex:-1})}),R({sortable:$[U],name:"onDrop",evt:r({},n,y===$?{}:{oldIndex:-1})})},_getEventProperties:function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n={};return n.event=t,n.to=$,n.from=y,n.node=g,n.clone=m,n.target=G,n.oldIndex=p,n.newIndex=x,n.pullMode=a,r(n,this.multiplayer.eventProperties(),e),n.relative=G===g?0:lt(m,G),n},_nulling:function(){$=y=g=b=ct=m=H=B=G=N=a=p=x=J=K=Y=q=W=X=V=Z=bt=D.clone=D.ghost=D.active=D.dragged=null,this.multiplayer.nulling(),this.autoScroller.nulling()},destroy:function(){this._cancelStart(),this._nulling(),M(this.el,"touchstart",this._onDrag),M(this.el,"mousedown",this._onDrag);var t=dt.indexOf(this.el);t>-1&&dt.splice(t,1),this.el[U]=this.animator=this.multiplayer=this.autoScroller=null},option:function(t,e){if(e===void 0)return this.options[t];this.options[t]=e,this.animator.options[t]=e,this.multiplayer.options[t]=e,this.autoScroller.options[t]=e,t==="group"&&wt(this.options)},select:function(t){this.multiplayer.select(t)},deselect:function(t){this.multiplayer.deselect(t)},getSelectedElements:function(){return this.multiplayer.selects}},D.utils={on:k,off:M,css:w,index:Q,closest:ht,getRect:L,toggleClass:F,detectDirection:rt},D.get=function(t){return t[U]},D.create=function(t,e){return new D(t,e)},D})})(Kt);var Vt=Kt.exports;const et=At(Vt);function Dt(d,o){let i;const r=function(...u){i||(o<=0?d.apply(this,u):i=setTimeout(()=>{i=null,d.apply(this,u)},o))};return r.cancel=function(){i&&(clearTimeout(i),i=null)},r}function qt(d,o){const i=Dt(d,o),r=function(){i.cancel(),i.apply(this,arguments)};return r.cancel=function(){i.cancel()},r}function Mt(d,o){return d==o}function Rt(d,o){return(Array.isArray(o)?o:o.replace(/\[/g,".").replace(/\]/g,".").split(".")).reduce((i,r)=>(i||{})[r],d)}function Ht(d){return d instanceof Document&&d.nodeType===9||d instanceof Window}const Bt=["delay","group","handle","lockAxis","disabled","sortable","draggable","animation","autoScroll","ghostClass","ghostStyle","chosenClass","scrollSpeed","fallbackOnBody","scrollThreshold","delayOnTouchOnly","placeholderClass"];class jt{constructor(o,i){this.el=o,this.options=i,this.rangeChanged=!1,this.installSortable()}destroy(){this.sortable.destroy(),this.rangeChanged=!1}option(o,i){this.options[o]=i,Bt.includes(o)&&this.sortable.option(o,i)}installSortable(){const o=Bt.reduce((i,r)=>(i[r]=this.options[r],i),{});this.sortable=new et(this.el,{...o,emptyInsertThreshold:0,swapOnDrop:i=>i.from===i.to,removeCloneOnDrop:i=>i.from===i.to,onDrag:i=>this.onDrag(i),onDrop:i=>this.onDrop(i),onChoose:i=>this.onChoose(i),onUnchoose:i=>this.onUnchoose(i)})}onChoose(o){this.dispatchEvent("onChoose",o)}onUnchoose(o){this.dispatchEvent("onUnchoose",o)}onDrag(o){const i=o.node.getAttribute("data-key"),r=this.getIndex(i),u=this.options.list[r],f=this.options.uniqueKeys[r];this.sortable.option("store",{item:u,key:f,index:r}),this.dispatchEvent("onDrag",{item:u,key:f,index:r,event:o})}onDrop(o){var j,nt,_;const{item:i,key:r,index:u}=(j=et.get(o.from))==null?void 0:j.option("store"),f=this.options.list,z={key:r,item:i,list:f,event:o,changed:!1,oldList:[...f],oldIndex:u,newIndex:u};o.from===o.to&&o.node===o.target||this.handleDropEvent(o,z,u),this.dispatchEvent("onDrop",z),o.from===this.el&&this.rangeChanged&&((nt=et.dragged)==null||nt.remove()),o.from!==o.to&&((_=et.clone)==null||_.remove()),this.rangeChanged=!1}handleDropEvent(o,i,r){const u=o.target.getAttribute("data-key");let f=-1,z=r;o.from===o.to?(z=this.getIndex(i.key),f=this.getIndex(u),(z<f&&o.relative===-1||z>f&&o.relative===1)&&(f+=o.relative),f!==z&&(i.list.splice(z,1),i.list.splice(f,0,i.item))):(o.from===this.el&&(z=this.getIndex(i.key),i.list.splice(z,1)),o.to===this.el&&(z=-1,f=this.getIndex(u),o.relative===0?f=i.list.length:o.relative===1&&(f+=o.relative),i.list.splice(f,0,i.item))),i.changed=o.from!==o.to||f!==z,i.oldIndex=z,i.newIndex=f}getIndex(o){if(o==null)return-1;const{uniqueKeys:i}=this.options;for(let r=0,u=i.length;r<u;r++)if(Mt(i[r],o))return r;return-1}dispatchEvent(o,i){const r=this.options[o];r&&r(i)}}const $t=["size","keeps","scroller","direction","debounceTime","throttleTime"];class Gt{constructor(o){this.options=o;const i={size:0,keeps:0,buffer:0,wrapper:null,scroller:null,direction:"vertical",uniqueKeys:[],debounceTime:null,throttleTime:null};for(const r in i)!(r in this.options)&&(this.options[r]=i[r]);this.sizes=new Map,this.sizeType="INIT",this.fixedSize=0,this.averageSize=0,this.range={start:0,end:0,front:0,behind:0},this.offset=0,this.direction="STATIONARY",this.updateScrollElement(),this.updateOnScrollFunction(),this.addScrollEventListener(),this.checkIfUpdate(0,o.keeps-1)}isFixed(){return this.sizeType==="FIXED"}isFront(){return this.direction==="FRONT"}isBehind(){return this.direction==="BEHIND"}isHorizontal(){return this.options.direction==="horizontal"}getSize(o){return this.sizes.get(o)||this.getItemSize()}getOffset(){const o=this.isHorizontal()?"scrollLeft":"scrollTop";return this.scrollEl[o]}getScrollSize(){const o=this.isHorizontal()?"scrollWidth":"scrollHeight";return this.scrollEl[o]}getClientSize(){const o=this.isHorizontal()?"offsetWidth":"offsetHeight";return this.scrollEl[o]}scrollToOffset(o){const i=this.isHorizontal()?"scrollLeft":"scrollTop";this.scrollEl[i]=o}scrollToIndex(o){if(o>=this.options.uniqueKeys.length-1)this.scrollToBottom();else{const i=this.getOffsetByRange(0,o),r=this.getScrollStartOffset();this.scrollToOffset(i+r)}}scrollToBottom(){const o=this.getScrollSize();this.scrollToOffset(o),setTimeout(()=>{const i=this.getClientSize(),r=this.getScrollSize();this.getOffset()+i+1<r&&this.scrollToBottom()},5)}option(o,i){const r=this.options[o];this.options[o]=i,o==="uniqueKeys"&&this.sizes.forEach((u,f)=>{i.includes(f)||this.sizes.delete(f)}),o==="scroller"&&(r&&et.utils.off(r,"scroll",this.onScroll),this.updateScrollElement(),this.addScrollEventListener())}updateRange(o){if(o){this.handleUpdate(o.start);return}let i=this.range.start;i=Math.max(i,0),this.handleUpdate(i)}onItemResized(o,i){!i||this.sizes.get(o)===i||(this.sizes.set(o,i),this.sizeType==="INIT"?(this.sizeType="FIXED",this.fixedSize=i):this.isFixed()&&this.fixedSize!==i&&(this.sizeType="DYNAMIC",this.fixedSize=0),!this.averageSize&&this.sizeType==="DYNAMIC"&&this.sizes.size===this.options.keeps&&this.updateAverageSize())}updateAverageSize(){const o=[...this.sizes.values()].reduce((i,r)=>i+r,0);this.averageSize=Math.round(o/this.sizes.size)}addScrollEventListener(){this.options.scroller&&et.utils.on(this.options.scroller,"scroll",this.onScroll)}removeScrollEventListener(){this.options.scroller&&et.utils.off(this.options.scroller,"scroll",this.onScroll)}enableScroll(o){const{scroller:i}=this.options,r=o?et.utils.off:et.utils.on,u="onwheel"in document.createElement("div")?"wheel":"mousewheel";r(i,"DOMMouseScroll",this.preventDefault),r(i,u,this.preventDefault),r(i,"touchmove",this.preventDefault),r(i,"keydown",this.preventDefaultForKeyDown)}preventDefault(o){o.preventDefault()}preventDefaultForKeyDown(o){if({37:1,38:1,39:1,40:1}[o.keyCode])return this.preventDefault(o),!1}updateScrollElement(){const o=this.options.scroller;if(Ht(o)){const i=document.scrollingElement||document.documentElement||document.body;this.scrollEl=i}else this.scrollEl=o}updateOnScrollFunction(){const{debounceTime:o,throttleTime:i}=this.options;o?this.onScroll=qt(()=>this.handleScroll(),o):i?this.onScroll=Dt(()=>this.handleScroll(),i):this.onScroll=()=>this.handleScroll()}handleScroll(){const o=this.getOffset(),i=this.getClientSize(),r=this.getScrollSize();o===this.offset?this.direction="STATIONARY":this.direction=o<this.offset?"FRONT":"BEHIND",this.offset=o;const u=this.isFront()&&o<=0,f=this.isBehind()&&i+o+1>=r;this.options.onScroll({top:u,bottom:f,offset:o,direction:this.direction}),this.isFront()?this.handleScrollFront():this.isBehind()&&this.handleScrollBehind()}handleScrollFront(){const o=this.getScrollItems();if(o>=this.range.start)return;const i=Math.max(o-this.options.buffer,0);this.checkIfUpdate(i,this.getEndByStart(i))}handleScrollBehind(){const o=this.getScrollItems();o<this.range.start+this.options.buffer||this.checkIfUpdate(o,this.getEndByStart(o))}getScrollItems(){const o=this.offset-this.getScrollStartOffset();if(o<=0)return 0;if(this.isFixed())return Math.floor(o/this.fixedSize);let i=0,r=this.options.uniqueKeys.length,u=0,f=0;for(;i<=r;){if(u=i+Math.floor((r-i)/2),f=this.getOffsetByRange(0,u),f===o)return u;f<o?i=u+1:f>o&&(r=u-1)}return i>0?--i:0}checkIfUpdate(o,i){const r=this.options.keeps;this.options.uniqueKeys.length<=r?o=0:i-o<r-1&&(o=i-r+1),this.range.start!==o&&this.handleUpdate(o)}handleUpdate(o){this.range.start=o,this.range.end=this.getEndByStart(o),this.range.front=this.getFrontOffset(),this.range.behind=this.getBehindOffset(),this.options.onUpdate({...this.range})}getFrontOffset(){return this.isFixed()?this.fixedSize*this.range.start:this.getOffsetByRange(0,this.range.start)}getBehindOffset(){const o=this.range.end,i=this.getLastIndex();return this.isFixed()?(i-o)*this.fixedSize:(i-o)*this.getItemSize()}getOffsetByRange(o,i){if(o>=i)return 0;let r=0;for(let u=o;u<i;u++){const f=this.sizes.get(this.options.uniqueKeys[u]);r=r+(typeof f=="number"?f:this.getItemSize())}return r}getEndByStart(o){return Math.min(o+this.options.keeps-1,this.getLastIndex())}getLastIndex(){const{uniqueKeys:o,keeps:i}=this.options;return o.length>0?o.length-1:i-1}getItemSize(){return this.isFixed()?this.fixedSize:this.options.size||this.averageSize}getScrollStartOffset(){const{wrapper:o,scroller:i}=this.options;if(i===o)return 0;let r=0;if(i&&o){const u=this.isHorizontal()?"left":"top",f=Ht(i)?et.utils.getRect(o):et.utils.getRect(o,!0,i);r=this.offset+f[u]}return r}}const Jt={modelValue:{},dataKey:{type:String,default:"",required:!0},tableMode:{type:Boolean,default:!1},draggable:{type:String,default:'[role="item"]'},sortable:{type:Boolean,default:!0},handle:{type:[Function,String],default:void 0},group:{type:[Object,String],default:void 0},scroller:{type:[Document,HTMLElement],default:void 0},lockAxis:{type:String,default:""},direction:{type:String,default:"vertical"},keeps:{type:Number,default:30},size:{type:Number,default:void 0},debounceTime:{type:Number,default:0},throttleTime:{type:Number,default:0},animation:{type:Number,default:150},autoScroll:{type:Boolean,default:!0},scrollSpeed:{type:Object,default:()=>({x:10,y:10})},scrollThreshold:{type:Number,default:55},keepOffset:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},fallbackOnBody:{type:Boolean,default:!1},delay:{type:Number,default:0},delayOnTouchOnly:{type:Boolean,default:!1},rootTag:{type:String,default:"div"},wrapTag:{type:String,default:"div"},wrapClass:{type:String,default:""},wrapStyle:{type:Object,default:()=>({})},ghostClass:{type:String,default:""},ghostStyle:{type:Object,default:()=>({})},chosenClass:{type:String,default:""},placeholderClass:{type:String,default:""}},Qt={dataKey:{type:[String,Number],default:void 0},sizeKey:{type:String,default:"offsetHeight"}},Zt=({mounted:d,updated:o,unmounted:i})=>Nt({props:["vnode"],mounted(){d(this.$el)},onUpdated(){o(this.$el)},onUnmounted(){i(this.$el)},render(r){return r.vnode}}),te=Nt({props:Qt,emits:["resize"],setup(d,{emit:o,slots:i}){let r=null;const u=_=>{const it=_?_[d.sizeKey]:0;o("resize",it,d.dataKey)},nt=Zt({mounted:_=>{typeof ResizeObserver<"u"&&(r=new ResizeObserver(()=>{u(_)}),_&&r.observe(_))},updated:_=>{u(_)},unmounted:()=>{r&&(r.disconnect(),r=null)}});return()=>{var k;const{dataKey:_}=d,[it]=((k=i.default)==null?void 0:k.call(i))||[];return vt(nt,{key:_,role:"item",vnode:it,"data-key":_},{default:()=>{var M;return(M=i.default)==null?void 0:M.call(i)}})}}}),ee=d=>Xt(d)?d.value:d,ie=Nt({props:Jt,emits:["update:modelValue","top","bottom","drag","drop","rangeChange"],setup(d,{emit:o,slots:i,expose:r}){const u=mt([]),f=mt({start:0,end:d.keeps-1,front:0,behind:0}),z=Ot(()=>d.direction!=="vertical"),j=mt(),nt=mt();function _(a){return S.getSize(a)}function it(){return S.getOffset()}function k(){return S.getClientSize()}function M(){return S.getScrollSize()}function gt(a){const p=ot.indexOf(a);p>-1&&S.scrollToIndex(p)}function L(a){S.scrollToOffset(a)}function ht(a){S.scrollToIndex(a)}function yt(){L(0)}function xt(){S.scrollToBottom()}r({getSize:_,getOffset:it,getClientSize:k,getScrollSize:M,scrollToTop:yt,scrollToBottom:xt,scrollToKey:gt,scrollToIndex:ht,scrollToOffset:L}),_t(()=>[d.modelValue],()=>{F()},{deep:!0}),Pt(()=>{F()}),Ft(()=>{S&&L(S.offset),S.addScrollEventListener()}),Ut(()=>{S.removeScrollEventListener()}),Yt(()=>{Tt(),B()}),Wt(()=>{y==null||y.destroy(),S==null||S.removeScrollEventListener()});let Q=[],ot=[],rt=0;const F=()=>{const a=ee(d.modelValue);if(a){if(u.value=a,ut(),w(Q,a),y==null||y.option("list",a),rt&&d.keepOffset){const p=a.length-rt;p>0&&ht(p),rt=0}Q=[...u.value]}},ut=()=>{ot=u.value.map(a=>Rt(a,d.dataKey)),S==null||S.option("uniqueKeys",ot),y==null||y.option("uniqueKeys",ot)},w=(a,p)=>{if(!a.length&&!p.length||a.length===p.length)return;let x={...f.value};a.length>d.keeps&&p.length>a.length&&x.end===a.length-1&&lt()&&x.start++,S==null||S.updateRange(x)},lt=()=>{const a=it(),p=k(),x=M();return a+p+1>=x};let S;const R=mt(!1),E=mt(""),at=Ot(()=>$t.reduce((a,p)=>(a[p]=d[p],a),{}));_t(at,(a,p)=>{if(S)for(let x in a)a[x]!==p[x]&&S.option(x,a[x])});const St=Dt(()=>{rt=u.value.length,o("top")},50),U=Dt(()=>{o("bottom")},50),It=a=>{rt=0,u.value.length&&a.top?St():a.bottom&&U()},zt=a=>{const p=a.start!==f.value.start;R.value&&p&&y&&(y.rangeChanged=!0),f.value=a,p&&o("rangeChange",a)},Tt=()=>{S=new Gt({...at.value,buffer:Math.round(d.keeps/3),wrapper:nt.value,scroller:d.scroller||j.value,uniqueKeys:ot,onScroll:It,onUpdate:zt})},$=(a,p)=>{if(Mt(p,E.value))return;const x=S.sizes.size,J=Math.min(d.keeps,u.value.length);S.onItemResized(p,a),x===J-1&&S.updateRange(f.value)};let y;const g=Ot(()=>Bt.reduce((a,p)=>(a[p]=d[p],a),{}));_t(g,(a,p)=>{if(y)for(let x in a)a[x]!==p[x]&&y.option(x,a[x])});const b=a=>{E.value=a.node.getAttribute("data-key")},ct=()=>{E.value=""},m=a=>{R.value=!0,d.sortable||(S.enableScroll(!1),y.option("autoScroll",!1)),o("drag",a)},H=a=>{R.value=!1,S.enableScroll(!0),y.option("autoScroll",d.autoScroll),a.changed&&o("update:modelValue",a.list),o("drop",a)},B=()=>{y=new jt(j.value,{...g.value,list:u.value,uniqueKeys:ot,onDrag:m,onDrop:H,onChoose:b,onUnchoose:ct})},G=a=>{const p=z.value?"width":"height";if(d.tableMode){const x={padding:0,border:0,[p]:`${a}px`};return vt("tr",{},[vt("td",{style:x})])}return null},N=()=>{const a=[],{start:p,end:x,front:J,behind:K}=f.value,Y=z.value?"offsetWidth":"offsetHeight";a.push(G(J));for(let q=p;q<=x;q++){const W=u.value[q];if(W){const X=Rt(W,d.dataKey),V=Mt(X,E.value);a.push(i.item?vt(te,{key:X,style:R.value&&V&&{display:"none"},dataKey:X,sizeKey:Y,onResize:$},{default:()=>{var Z;return(Z=i.item)==null?void 0:Z.call(i,{record:W,index:q,dataKey:X})}}):null)}}return a.push(G(K)),a};return()=>{const{front:a,behind:p}=f.value,{tableMode:x,rootTag:J,wrapTag:K,scroller:Y,wrapClass:q,wrapStyle:W}=d,X=z.value?"auto hidden":"hidden auto",V=z.value?`0 ${p}px 0 ${a}px`:`${a}px 0 ${p}px`,Z=x?"table":J,bt=x?"tbody":K;return vt(Z,{ref:j,style:!Y&&!x&&{overflow:X}},{default:()=>{var dt,wt;return[(dt=i.header)==null?void 0:dt.call(i),vt(bt,{ref:nt,class:q,style:{...W,padding:!x&&V}},{default:()=>N()}),(wt=i.footer)==null?void 0:wt.call(i)]}})}}});export{ie as default};
